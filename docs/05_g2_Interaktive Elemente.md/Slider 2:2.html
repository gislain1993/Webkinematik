<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1,user-scalable=no">
<meta name="description" content="Steuerung und Manipulation von Animationen und Grafiken im Webbrowser">

<meta name="date" content="Wed Jan 01 2020 00:00:00 GMT+0100 (Central European Standard Time)">
<meta name="keywords" content="Web,Animation,Interaktivität,Grundlagen,JavaScript,HTML,Input,Programmierung,g2,Canvas">
<title>Einführung in die Interaktivität</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/tomorrow-night-bright.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.css">
<link rel="stylesheet" href="../theme/style.css">
</head>
<body id="top">
<main>
  <nav>
<p><a href="../index.html"><img src="../img/cover.png"></img></a></p>
<h2 id="inhaltsverzeichnis">Inhaltsverzeichnis</h2>
<ol start="1">
    <li><details><summary markdown="span">Mechanismentechnik Wiederholung</summary>
        <ol>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Getriebekinematik.html">Getriebekinematik</a></li> 
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Lageanalyse des Viergelenks.html">Lageanalyse des Viergelenks</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Übertragungsgleichung.html">Übertragungsgleichung und Übertragungsfunktion</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Koppelkurven.html">Koppelkurven</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Geschwindigkeit.html">Geschwindigkeit</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Beschleunigung.html">Beschleunigung</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Relativbewegung.html">Relativbewegung</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Pole der ebenen Bewegung.html">Pole der ebenen Bewegung</a></li> 
        </ol>
    </details></li>
</ol>
<ol start="2">
    <li><details><summary markdown="span">Webtechnologien</summary>
    <ol>
        <li><a href="../02_Webtechnologie.md/Grundlagen.html">Grundlagen</a></li>
        <li><a href="../02_Webtechnologie.md/Uebungen.html">Übungen</a></li> 
    </ol>
    </details></li>
</ol>
<ol start="3">
    <li><details><summary markdown="span">Grafik mit der Bibliotek g2</summary>
    <ol>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/Grafik im Webbrowser.html">Grafik im Webbrowser</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2 Methode.html">Methoden der g2 Bibliothek</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2ExtErweiterung.html">Erweiterung g2.ext</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2mecErweiterung.html">Erweiterung g2.mec</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2 ChartErweiterung.html">Erweiterung g2.chart</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/Übungen.html">Übungen</a></li>
    </ol>
    </details></li>
</ol>
<ol start="4">
    <li><details><summary markdown="span">g2 Animation</summary>
    <ol>
        <li><a href="../04_g2_Animation.md/Animation mit g2 am Beispiel.html">Animation mit g2 am Beispiel einer Kurbel</a></li>
        <li><a href="../04_g2_Animation.md/Übung-Federschwinge.html">Übung - Federschwinge</a></li>
        <li><a href="../04_g2_Animation.md/Übung-Rad.html">Übung - Rad</a></li>
        <li><a href="../04_g2_Animation.md/Übung-Pendelrolle.html">Übung - Pendelrolle</a></li>
    </ol>
    </details></li>
</ol>
<ol start="5">
    <li><details><summary markdown="span">g2 Interaktive Elemente</summary>
    <ol>
        <li><a href="../05_g2_Interaktive Elemente.md/Button.html">Button</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Dropdown Menü.html">Dropdown Menü</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Checkbox.html">Checkbox</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Slider 1:2.html">Slider 1/2</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Slider 2:2.html">Slider 2/2</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/GUI Bibliotheken.html">GUI Bibliotheken</a></li>
    </ol>
    </details></li>
</ol>
<ol start="6">
    <li><details><summary markdown="span">Die 5 Grundfälle der ebenen Vektoralgebra</summary>
    <ol>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall I.html">Grundfall I</a></li>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall II & III.html">Grundfall II & III</a></li>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall IV.html">Grundfall IV</a></li>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall V.html">Grundfall V</a></li> 
    </ol>
    </details></li>
</ol>
</nav>

<article>

<header>
<h1>Einführung in die Interaktivität</h1>
<h3>Slider</h3>


<h5>Oktober 2020</h5>
<h5><b>Keywords:</b> Web, Animation, Interaktivität, Grundlagen, JavaScript, HTML, Input, Programmierung, g2, Canvas</h5>
</header>
<aside style="min-width:45%">
<iframe width=100% height=450 frameborder='no' src='https://goessner.github.io/webkinematik/Interaktivitaet/5 Kurbel - 2 slider.html'></iframe>
</aside>
<h2 id="56-slider---teil">5.6 Slider - Teil 2</h2>
<p>Auch wenn wir unser Animationsbeispiel bereits um einige Steuerelemente erweitert haben, bleibt es doch eine Animation. Um vollständige Interaktivität zu erreichen koppeln wir nun <code>phi</code> mit einem Slider. Zuerst entfernen wir, bis auf den Slider für <code>l</code>, alles wieder was wir in diesem Kapitel hinzugefügt haben (oder laden die folgende Vorlage runter).</p>
<p><br><br><br><br><br><br><br><br><br></p>
<pre><code class="code-line language-HTML"><div><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">'utf-8'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>      
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>             
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"c"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border-width:1px;border-style:solid"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"lslider"</span>&gt;</span>l:
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"lslider"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:240px;vertical-align:middle;padding:0"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"150"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"100"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"lout"</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"lslider"</span> &gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span>mm
    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://gitcdn.xyz/repo/goessner/g2/master/src/g2.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>    
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
 
<span class="hljs-keyword">let</span> cnv = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'c'</span>),
    ctx = cnv.getContext(<span class="hljs-string">'2d'</span>),
    lslider = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'lslider'</span>),
    lout = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'lout'</span>),    
    pi = <span class="hljs-built_in">Math</span>.PI,
    l = <span class="hljs-number">100</span>,  <span class="hljs-comment">// Laenge der Kurbel</span>
    phi = <span class="hljs-number">0</span>, <span class="hljs-comment">// Laufvariable</span>
    mec = {
        <span class="hljs-keyword">get</span> ephi() { <span class="hljs-keyword">return</span> {<span class="hljs-attr">x</span>:<span class="hljs-built_in">Math</span>.cos(phi), <span class="hljs-attr">y</span>:<span class="hljs-built_in">Math</span>.sin(phi)}; },
        <span class="hljs-keyword">get</span> A() { <span class="hljs-keyword">return</span> {<span class="hljs-attr">x</span>:l*mec.ephi.x, <span class="hljs-attr">y</span>:l*mec.ephi.y}; }
    },  
    kurbel = g2(),  <span class="hljs-comment">// definiert Kurbel als g2() Objekt</span>
    <span class="hljs-comment">// baut und initialisiert statische Umgebung</span>
    world = g2().clr().view({<span class="hljs-attr">x</span>:<span class="hljs-number">150</span>,<span class="hljs-attr">y</span>:<span class="hljs-number">150</span>,<span class="hljs-attr">cartesian</span>:<span class="hljs-literal">true</span>})
                .use({<span class="hljs-attr">grp</span>:kurbel})
                .nodfix()
    ;
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">position</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// baut dynamische Kurbel auf</span>
    kurbel.del()
          .lin({<span class="hljs-attr">x1</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">y1</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">x2</span>:mec.A.x, <span class="hljs-attr">y2</span>:mec.A.y, <span class="hljs-attr">lw</span>:<span class="hljs-number">3</span>})
          .nod(mec.A);
}        
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params"></span>) </span>{
    position();  <span class="hljs-comment">// aktualisiere Position</span>
    world.exe(ctx);  <span class="hljs-comment">// rendert world in den Context</span>
    requestAnimationFrame(render);  <span class="hljs-comment">// asynchroner callback von render(), keine Rekursion!</span>
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setl</span>(<span class="hljs-params"></span>) </span>{
    l = lslider.value;
    lout.innerHTML = lslider.value;
}
 
<span class="hljs-comment">/*
 *  Initialisierung
 */</span>
 
<span class="hljs-comment">// Eventlistener hinzufuegen</span>
lslider.addEventListener(<span class="hljs-string">"input"</span>,setl);  <span class="hljs-comment">// bei hohem Rechenaufwand ist "change" sinnvoller</span>
<span class="hljs-comment">// Animation starten</span>
render();
 
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Wir fügen im HTML-Teil einen In- und Output für <code>phi</code> von 0 bis 360° hinzu:</p>
<pre><code class="code-line language-HTML"><div><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"phislider"</span>&gt;</span>&amp;varphi;:
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"phislider"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:240px;vertical-align:middle;padding:0"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"360"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"phiout"</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"phislider"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span>°
<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
</div></code></pre>
<p>In Zeile 3 des obigen Code-Schnipsels steht <code>&amp;phi;</code>. Es handelt sich hierbei um Unicode bzw. den entsprechenden HTML Namen. Weitere nützliche Unicode Zeichen findet man z.B. <a href="https://unicode-table.com/de/">hier</a>.</p>
<p>Nachdem wieder Abkürzungen für in- und Output</p>
<p><code>phislider = document.getElementById('phislider')</code><br>
<code>phiout = document.getElementById('phiout')</code></p>
<p>angelegt, ein Eventlistener hinzugefügt</p>
<p><code>phislider.addEventListener(&quot;input&quot;,setPhi)</code></p>
<p>und die Listener-Funktion erstellt wurde,</p>
<pre><code class="code-line language-JavaScript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPhi</span>(<span class="hljs-params"></span>) </span>{
    phi = phislider.value*pi/<span class="hljs-number">180</span>;
    phiout.innerHTML = phislider.value;
}
</div></code></pre>
<p>ist das Beispiel im Grunde fertig und funktioniert.</p>
<h3 id="561-dirty-flags">5.6.1 dirty flags</h3>
<p>Dennoch soll an dieser Stelle das Konzept sogenannter &quot;dirty flags&quot; eingeführt werden.</p>
<p>Wenn man interaktive Webkinematik betreibt, nutz man dazu meistens <code>requestAnimationFrame(callback)</code>. Da der Callback bei modernen Systemen ununterbrochen mindestens alle 16,67ms erfolgt, werden auch alle Berechnungen innerhalb der Callback-Funktion jedes Mal erneut ausgeführt.<br>
Wenn nun aber wie bei uns ein statischer Mechanismus vorliegt — solange man den entsprechenden Schieberegler nicht bewegt — wird unnötigerweise immer wieder dasselbe berechnet. Somit wäre es aus Performancegründen sicherlich wünschenswert, wenn Berechnungen nur stattfinden nachdem Änderungen eingetreten sind.</p>
<p>Zudem können auch viele Inputs oder tief verschachtelte Getter sehr an der Performance zehren. Man möchte nicht immer sofort alles aktualisieren, wenn man nur eine Kleinigkeit ändert. Dazu kann man sein mechanisches System oder auch sein Canvas in mehrere Bereiche/Schichten einteilen und mittels Booleans nur den Bereich aktualisieren der eine Änderung erfahren hat. Dazu fügen nun zuerst in den Script Variablen mit</p>
<p><code>dirty = true</code></p>
<p>den erwähnten Boolean hinzu. Wenn dieser <code>true</code> ist, gibt es eine Abweichung von Soll Zustand und es muss etwas aktualisiert werden. Da das beim initialen Laden der Seite auf jeden Fall so ist, initialisieren wir <code>dirty</code> entsprechend.</p>
<p>Anschließend ändern wir jede unsere Listener-Funktionen dahingehend, dass in ihnen <code>dirty</code> auf <code>true</code> gesetzt wird, denn hier finden ja die Änderungen statt, die Aktualisierungen erforderlich machen.</p>
<p><code>setPhi()</code> sieht nun folgendermaßen aus:</p>
<pre><code class="code-line language-JavaScript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPhi</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (phislider.value != phiout.value) {
        phi = phislider.value*pi/<span class="hljs-number">180</span>;
        phiout.innerHTML = phislider.value;
        dirty = <span class="hljs-literal">true</span>;
    }
}
</div></code></pre>
<p>und <code>setl()</code> dementsprechend so:</p>
<pre><code class="code-line language-JavaScript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setl</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (lslider.value != lout.value) {
        l = lslider.value;
        lout.innerHTML = lslider.value;
        dirty = <span class="hljs-literal">true</span>;
    }
}
</div></code></pre>
<p>Stellt man <code>dirty</code> in <code>setl()</code> auf <code>false</code>, wird die Kurbellänge, trotz Input-Event, erst aktualisiert sobald man den ϕ-Slider bewegt.</p>
<p>In beiden Funktionen wird am Anfang geprüft ob es eine Abweichung zwischen Input und Output gibt. Wenn das so ist, wird die Änderung der Werte vorgenommen und anschließend <code>dirty</code> auf <code>true</code> gesetzt.</p>
<p>Die Abfrage von <code>dirty</code> geschieht dann in der <code>render()</code> Funktion die jetzt so aussieht:</p>
<pre><code class="code-line language-JavaScript"><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (dirty) {
        position();  <span class="hljs-comment">// aktualisiere Position</span>
        world.exe(ctx);  <span class="hljs-comment">// rendert world in den Context</span>
        dirty = <span class="hljs-literal">false</span>;
    }
    requestAnimationFrame(render);  <span class="hljs-comment">// asynchroner callback von render(), keine Rekursion!</span>
}
</div></code></pre>
<p>Wenn <code>dirty</code> hier <code>true</code> ist, gibt es etwas zu aktualisieren. Es werden die entsprechenden Funktionen aufgerufen und anschließend mit der Zuweisung <code>dirty = false</code> vermerkt, dass im nächsten Durchgang nichts aktualisiert werden muss; d.h. so lange es keine erneuten Änderungen gibt. <code>requestAnimationFrame(render)</code> steht außerhalb der Bedingung, da diese Zeile ja die &quot;Animation&quot; bzw. App am Laufen hält.</p>
<h3 id="561-ergebnis">5.6.1 Ergebnis</h3>
<p>Das fertige HTML-Dokument sollte nun folgendermaßen aussehen:</p>
<pre><code class="code-line language-HTML"><div><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">'utf-8'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"c"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border-width:1px;border-style:solid"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"phislider"</span>&gt;</span>&amp;phi;:
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"phislider"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:240px;vertical-align:middle;padding:0"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"360"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"phiout"</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"phislider"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span>°
    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"lslider"</span>&gt;</span>l:
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"lslider"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width:240px;vertical-align:middle;padding:0"</span> <span class="hljs-attr">min</span>=<span class="hljs-string">"20"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"150"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"100"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"lout"</span> <span class="hljs-attr">for</span>=<span class="hljs-string">"lslider"</span>&gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span>mm
    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://gitcdn.xyz/repo/goessner/g2/master/src/g2.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
 
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">let</span> cnv = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'c'</span>),
    ctx = cnv.getContext(<span class="hljs-string">'2d'</span>),
    phislider = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'phislider'</span>),
    phiout = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'phiout'</span>),
    lslider = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'lslider'</span>),
    lout = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'lout'</span>),
    pi = <span class="hljs-built_in">Math</span>.PI,
    l = <span class="hljs-number">100</span>,  <span class="hljs-comment">// Laenge der Kurbel</span>
    phi = <span class="hljs-number">0</span>, <span class="hljs-comment">// Laufvariable</span>
    mec = {
        <span class="hljs-keyword">get</span> ephi() { <span class="hljs-keyword">return</span> {<span class="hljs-attr">x</span>:<span class="hljs-built_in">Math</span>.cos(phi), <span class="hljs-attr">y</span>:<span class="hljs-built_in">Math</span>.sin(phi)}; },
        <span class="hljs-keyword">get</span> A() { <span class="hljs-keyword">return</span> {<span class="hljs-attr">x</span>:l*mec.ephi.x, <span class="hljs-attr">y</span>:l*mec.ephi.y}; }
    },
    kurbel = g2(),  <span class="hljs-comment">// definiert Kurbel als g2() Objekt</span>
    <span class="hljs-comment">// baut und initialisiert statische Umgebung</span>
    world = g2().clr().view({<span class="hljs-attr">x</span>:<span class="hljs-number">150</span>,<span class="hljs-attr">y</span>:<span class="hljs-number">150</span>,<span class="hljs-attr">cartesian</span>:<span class="hljs-literal">true</span>})
                .use({<span class="hljs-attr">grp</span>:kurbel})
                .nodfix(),
    dirty = <span class="hljs-literal">true</span>  <span class="hljs-comment">// wenn true gibt es was zu aktualisieren</span>
    ;
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">position</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// baut dynamische Kurbel auf</span>
    kurbel.del()
          .lin({<span class="hljs-attr">x1</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">y1</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">x2</span>:mec.A.x, <span class="hljs-attr">y2</span>:mec.A.y, <span class="hljs-attr">lw</span>:<span class="hljs-number">3</span>})
          .nod(mec.A);
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (dirty) {
        position();  <span class="hljs-comment">// aktualisiere Position</span>
        world.exe(ctx);  <span class="hljs-comment">// rendert world in den Context</span>
        dirty = <span class="hljs-literal">false</span>;
    }
    requestAnimationFrame(render);  <span class="hljs-comment">// asynchroner callback von render(), keine Rekursion!</span>
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setPhi</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (phislider.value != phiout.value) {
        phi = phislider.value*pi/<span class="hljs-number">180</span>;
        phiout.innerHTML = phislider.value;
        dirty = <span class="hljs-literal">true</span>;
    }
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setl</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (lslider.value != lout.value) {
        l = lslider.value;
        lout.innerHTML = lslider.value;
        dirty = <span class="hljs-literal">true</span>;
    }
}
 
<span class="hljs-comment">/*
 *  Initialisierung
 */</span>
 
<span class="hljs-comment">// Eventlistener hinzufuegen</span>
phislider.addEventListener(<span class="hljs-string">"input"</span>,setPhi);
lslider.addEventListener(<span class="hljs-string">"input"</span>,setl);  <span class="hljs-comment">// bei hohem Rechenaufwand ist "change" sinnvoller</span>
<span class="hljs-comment">// Animation starten</span>
render();
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>

</article>
</main>
<script src="../js/g2.html.js"></script>
<script src="../js/mec2.html.js"></script>
</body>
</html>