<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1,user-scalable=no">
<meta name="description" content="Notwendige Kentnisse zur Bearbeitung eines Projekts von Webkinematik">

<meta name="date" content="Wed Jan 01 2020 00:00:00 GMT+0100 (Central European Standard Time)">
<meta name="keywords" content="mechanismentechnik,Bewegungs- und Kraftübertragung,g2">
<title>Dokumentation von Webkinematik</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.18.1/styles/tomorrow-night-bright.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.css">
<link rel="stylesheet" href="../theme/style.css">
</head>
<body id="top">
<main>
  <nav>
<p><a href="../index.html"><img src="../img/cover.png"></img></a></p>
<h2 id="inhaltsverzeichnis">Inhaltsverzeichnis</h2>
<ol start="1">
    <li><details><summary markdown="span">Mechanismentechnik Wiederholung</summary>
        <ol>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Getriebekinematik.html">Getriebekinematik</a></li> 
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Lageanalyse des Viergelenks.html">Lageanalyse des Viergelenks</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Übertragungsgleichung.html">Übertragungsgleichung und Übertragungsfunktion</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Koppelkurven.html">Koppelkurven</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Geschwindigkeit.html">Geschwindigkeit</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Beschleunigung.html">Beschleunigung</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Relativbewegung.html">Relativbewegung</a></li>
        <li><a href="../01_Mechanismentechnik_Wiederholung.md/Pole der ebenen Bewegung.html">Pole der ebenen Bewegung</a></li> 
        </ol>
    </details></li>
</ol>
<ol start="2">
    <li><details><summary markdown="span">Webtechnologien</summary>
    <ol>
        <li><a href="../02_Webtechnologie.md/Grundlagen.html">Grundlagen</a></li>
        <li><a href="../02_Webtechnologie.md/Uebungen.html">Übungen</a></li> 
    </ol>
    </details></li>
</ol>
<ol start="3">
    <li><details><summary markdown="span">Grafik mit der Bibliotek g2</summary>
    <ol>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/Grafik im Webbrowser.html">Grafik im Webbrowser</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2 Methode.html">Methoden der g2 Bibliothek</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2ExtErweiterung.html">Erweiterung g2.ext</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2mecErweiterung.html">Erweiterung g2.mec</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/g2 ChartErweiterung.html">Erweiterung g2.chart</a></li>
        <li><a href="../03_Grafik_mit_der_Bibliothek_g2.md/Übungen.html">Übungen</a></li>
    </ol>
    </details></li>
</ol>
<ol start="4">
    <li><details><summary markdown="span">g2 Animation</summary>
    <ol>
        <li><a href="../04_g2_Animation.md/Animation mit g2 am Beispiel.html">Animation mit g2 am Beispiel einer Kurbel</a></li>
        <li><a href="../04_g2_Animation.md/Übung-Federschwinge.html">Übung - Federschwinge</a></li>
        <li><a href="../04_g2_Animation.md/Übung-Rad.html">Übung - Rad</a></li>
        <li><a href="../04_g2_Animation.md/Übung-Pendelrolle.html">Übung - Pendelrolle</a></li>
    </ol>
    </details></li>
</ol>
<ol start="5">
    <li><details><summary markdown="span">g2 Interaktive Elemente</summary>
    <ol>
        <li><a href="../05_g2_Interaktive Elemente.md/Einführung Interaktivität.html">Einführung Interaktivität</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Button.html">Button</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Dropdown Menü.html">Dropdown Menü</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Checkbox.html">Checkbox</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Slider 1:2.html">Slider 1/2</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/Slider 2:2.html">Slider 2/2</a></li>
        <li><a href="../05_g2_Interaktive Elemente.md/GUI Bibliotheken.html">GUI Bibliotheken</a></li>
    </ol>
    </details></li>
</ol>
<ol start="6">
    <li><details><summary markdown="span">Die 5 Grundfälle der ebenen Vektoralgebra</summary>
    <ol>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall I.html">Grundfall I</a></li>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall II & III.html">Grundfall II & III</a></li>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall IV.html">Grundfall IV</a></li>
        <li><a href="../06_Die_5_Grundfaelle_der_ebenen_Vektoralgebra.md/Grundfall V.html">Grundfall V</a></li> 
    </ol>
    </details></li>
</ol>
</nav>

<article>

<header>
<h1>Dokumentation von Webkinematik</h1>



<h5>Oktober 2020</h5>
<h5><b>Keywords:</b> mechanismentechnik, Bewegungs- und Kraftübertragung, g2</h5>
</header>
<h4 id="gui-bibliotheken">GUI Bibliotheken</h4>
<p>Das Erstellen und Handling von Steuerelementen mittels HTML Tags und Eventlistenern, wie es auf den vorangegangenen Seiten gezeigt wurde, ist zwar zielführend und schränkt den Entwickler programmatisch nicht ein, kann dafür aber sehr schnell aufwändig und unübersichtlich werden.
Die modernere Methode Webapps mit GUI zu entwickeln sind Frontendframeworks, wie z.B. Facebooks <a href="https://reactjs.org">React.js</a> oder die Open Source Alternative <a href="https://vuejs.org">Vue.js</a>. Diese setzen auf ein virtuelles DOM, d.h. im <code>body</code> steht meist nur noch ein Tag <code>&lt;div id=‘app‘&gt;&lt;/div&gt;</code>, in den die restliche App via JavaScript injiziert und gehandled wird. Für Microapps wie die im Rahmen dieses Kurses behandelten, wäre die Nutzung solcher Frameworks aber wie mit Kanonen auf Spatzen zu schießen. Stattdessen bieten sich minimalistische GUI Bibliotheken an, die lediglich die Ein- und Ausgabeelemente vom HTML entkoppeln.
Besonders empfehlenswert sind dabei <a href="http://workshop.chromeexperiments.com/examples/gui/#1--Basic-Usage">dat.GUI</a> von Google und <a href="https://github.com/bit101/quicksettings">QuickSettings.js</a> von Keith Peters. Da QuickSettings, der Meinung des Autors dieses Kurses nach, die mächtigere Variante ist, beschränken wir uns darauf.</p>
<blockquote>
<p>Keith Peters betreibt übrigens einen interessanten <a href="https://www.youtube.com/channel/UCF6F8LdCSWlRwQm_hfA2bcQ">Youtube Kanal</a>, wo er sich mit der Lösung mathematischer und physikalischen Problemen unter der Verwendung von Webtechnologien beschäftigt. Dort gibt es unter anderem auch ein kurzes <a href="https://www.youtube.com/watch?v=vpSy9f-hKhQ">Tutorial</a> zu QuickSettings falls jemand lieber ein Video schaut statt zu lesen.</p>
</blockquote>
<p>Als Beispiel sollen die Ein- und Ausgabeelemente für die App aus Kapitel Slider 1/2 mit QuickSettings erstellt werden.</p>
<iframe width=100% height=350 frameborder='no' src='https://goessner.github.io/webkinematik/Interaktivitaet/6 Kurbel - qsmin.html'></iframe>
<p>Dazu können zuerst einmal sämtliche HTML-Elemente, bis auf das canvas, aus dem <code>body</code> entfernt werden da diese nicht mehr benötigt werden. Zudem fügen wir den CDN Link für QuickSettings ein, den wir auf dem Github Repository finden:</p>
<pre><code class="code-line language-HTML"><div><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">'utf-8'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"c"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border-width:1px;border-style:solid"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://gitcdn.xyz/repo/goessner/g2/master/src/g2.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/quicksettings@latest/quicksettings.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>
    ...
</div></code></pre>
<p>Die am Anfang des Appscripts auf Variablen gelegten HTML-Elemente (mit Ausnahme der beiden canvas-Variablen) werden ebenso nicht mehr benötigt, wie sämtliche Eventlistener von Schluss.</p>
<pre><code class="code-line language-HTML"><div>const cnv = document.getElementById('c'),
      ctx = cnv.getContext('2d'),
      pi = Math.PI;
 
let l = 100,  // Laenge der Kurbel 
    phi = 0, // Laufvariable
    speedmod = 1,  // Faktor der die Geschwindigkeit modifiziert
 
    mec = {
        get ephi() { return {x:Math.cos(phi), y:Math.sin(phi)}; },
        get A() { return {x:l*mec.ephi.x, y:l*mec.ephi.y}; }
    },
 
    Kurbel = g2(),  // definiert Kurbel als g2() Objekt
 
    // baut und initialisiert statische Umgebung
    world = g2().clr().view({x:150,y:150,cartesian:true})
                .use({grp:Kurbel})
                .nodfix(),
 
    run = true  // Boolean als Schalter um zu pruefen ob Animation laeuft
    ...
</div></code></pre>
<p>Nachdem alles entfernt wurde folgt nun eine neue Variable, hier <code>gui</code> genannt, der ein neues QuickSettings Steuerungspanel, erstellt mit der Methode <code>Quicksettings.create(x,y,Titel)</code>, zugewiesen wird. An dieses Panel können beliebige Steuerelemente durch Verkettung, wie von g2 gewohnt, angehangen werden.</p>
<pre><code class="code-line language-HTML"><div>gui = QuickSettings.create(318, 8, 'Kurbel') // Initiale Position vom body margin: 8px, canvas + border 300 + 2px
                   .addButton('Start/Stop', startstop)
                   .addDropDown('Geschwindigkeit', [0.5,1,2,4], changeSpeed)
                   .addHTML('Periodendauer', `${6/speedmod}s`)
                   .addBoolean('Drehrichtung umkehren', false) // kein Callback notwendig weil im Animationscallback (render() -&gt; positiom()) evaluiert
                   .addRange('l', 20, 150, 100, 1, setl)
    ;
    ...
</div></code></pre>
<p>Die meisten QuickSettings Methoden nehmen als Argumente einen Titel, der gebraucht wird um das entsprechende Element später zu finden (wie id bei HTML Tags), einen oder mehrere Werte, sowie einen Callback, der bei Interaktion ausgeführt wird und somit die Eventlistener ersetzt.</p>
<p>Die QuickSettings Methoden sollen hier nicht einzeln unter die Lupe genommen werden. Bitte werfen die dazu einen Blick in die <a href="https://github.com/bit101/quicksettings">Dokumentation</a> und die <a href="http://bit101.github.io/quicksettings/demos/master_demo.html">Masterdemo</a>.</p>
<p>Darauf hingewiesen sei jedoch, dass der Ausdruck in Zeile 4 ein <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/template_strings">Template-String</a> ist. Diese Strings erlauben das Einbetten von Variablen, die auch ausgewertet werden wenn der String evaluiert wird und somit JavaScript Variablen in HTML ermöglichen. Variablen schreibt man dabei immer in die geschweiften Klammern denen ein Dollarzeichen voransteht <code>${Variable}</code>.
An Werte aus den GUI-Elementen gelangt man Grundsätzlich mit der Methode gui.getValue(Elementtitel) (analog gibt es auch <code>gui.getValue(Elementtitel, Wert)</code>. Der Rückgabewert kann ein beliebiger Datentyp sein. Welcher ist immer in der Dokumentation nachzulesen oder durch loggen in er ein Konsole ersichtlich.
Aus <code>position()</code> gibt es <code>Drehrichtung</code>.checked nicht mehr, den Wert der neuen Checkbox fragt man via <code>gui.getValue('Drehrichtung umkehren')</code> ab. Aus <code>changeSpeed()</code> und <code>setl()</code> werden:</p>
<pre><code class="code-line language-HTML"><div>function changeSpeed() {
    // weist dem speedmodifier den Wert der ausgewaehlten Option zu
    speedmod = +gui.getValue('Geschwindigkeit').value;
    // aktualisiert den Output
    gui.setValue('Periodendauer', `${6/speedmod}s`);
}
 
function setl() {
    l = gui.getValue('l');
}
</div></code></pre>
<p>Das Dropdown Element gibt ein Objekt zurück, das Index und Wert der gewählten Option enthält.
<code>gui.getValue('Geschwindigkeit') // Object { index: 1, value: &quot;1&quot; }</code></p>
<p>Der fertige Quelltext sieht dann so aus:</p>
<pre><code class="code-line language-HTML"><div><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">'utf-8'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"c"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border-width:1px;border-style:solid"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://gitcdn.xyz/repo/goessner/g2/master/src/g2.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/quicksettings@latest/quicksettings.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
 
<span class="hljs-keyword">const</span> cnv = document.getElementById(<span class="hljs-string">'c'</span>),
      ctx = cnv.getContext(<span class="hljs-string">'2d'</span>),
      pi = Math.PI;
 
 
 
let l = <span class="hljs-number">100</span>,  <span class="hljs-comment">// Laenge der Kurbel </span>
    phi = <span class="hljs-number">0</span>, <span class="hljs-comment">// Laufvariable</span>
    speedmod = <span class="hljs-number">1</span>,  <span class="hljs-comment">// Faktor der die Geschwindigkeit modifiziert</span>
 
    mec = {
        <span class="hljs-keyword">get</span> ephi() { <span class="hljs-keyword">return</span> {x:Math.cos(phi), y:Math.sin(phi)}; },
        <span class="hljs-keyword">get</span> A() { <span class="hljs-keyword">return</span> {x:l*mec.ephi.x, y:l*mec.ephi.y}; }
    },
 
    Kurbel = g2(),  <span class="hljs-comment">// definiert Kurbel als g2() Objekt</span>
 
    <span class="hljs-comment">// baut und initialisiert statische Umgebung</span>
    world = g2().clr().view({x:<span class="hljs-number">150</span>,y:<span class="hljs-number">150</span>,cartesian:<span class="hljs-literal">true</span>})
                .use({grp:Kurbel})
                .nodfix(),
 
    run = <span class="hljs-literal">true</span>  <span class="hljs-comment">// Boolean als Schalter um zu pruefen ob Animation laeuft</span>
 
    gui = QuickSettings.create(<span class="hljs-number">318</span>, <span class="hljs-number">8</span>, <span class="hljs-string">'Kurbel'</span>) <span class="hljs-comment">// Initiale Position vom body margin: 8px, canvas + border 300 + 2px</span>
                       .addButton(<span class="hljs-string">'Start/Stop'</span>, startstop)
                       .addDropDown(<span class="hljs-string">'Geschwindigkeit'</span>, [<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], changeSpeed)
                       .addHTML(<span class="hljs-string">'Periodendauer'</span>, `${<span class="hljs-number">6</span>/speedmod}s`)
                       .addBoolean(<span class="hljs-string">'Drehrichtung umkehren'</span>, <span class="hljs-literal">false</span>) <span class="hljs-comment">// kein Callback notwendig weil im Animationscallback (render() -&gt; positiom()) evaluiert</span>
                       .addRange(<span class="hljs-string">'l'</span>, <span class="hljs-number">20</span>, <span class="hljs-number">150</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, setl)
    ;
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">position</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// baut dynamische Kurbel auf</span>
    Kurbel.del()
          .lin({x1:<span class="hljs-number">0</span>, y1:<span class="hljs-number">0</span>, x2:mec.A.x, y2:mec.A.y, lw:<span class="hljs-number">3</span>})
          .nod(mec.A);
 
    <span class="hljs-comment">// inkrementiert phi</span>
    <span class="hljs-keyword">if</span> (run) {
        <span class="hljs-keyword">if</span> (gui.getValue(<span class="hljs-string">'Drehrichtung umkehren'</span>)) {
            phi -= speedmod*pi/<span class="hljs-number">180</span>;
        } <span class="hljs-keyword">else</span> {
            phi += speedmod*pi/<span class="hljs-number">180</span>;
        }
    }
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span><span class="hljs-params">()</span> </span>{
    position();  <span class="hljs-comment">// aktualisiere Position</span>
    world.exe(ctx);  <span class="hljs-comment">// rendert world in den Context</span>
    requestAnimationFrame(render);  <span class="hljs-comment">// asynchroner callback von render(), keine Rekursion!</span>
}
 
<span class="hljs-comment">// wechselt Status der Lauferlaubnis</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startstop</span><span class="hljs-params">()</span> </span>{
    run = !run;
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeSpeed</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// weist dem speedmodifier den Wert der ausgewaehlten Option zu</span>
    speedmod = +gui.getValue(<span class="hljs-string">'Geschwindigkeit'</span>).value;
    <span class="hljs-comment">// aktualisiert den Output</span>
    gui.setValue(<span class="hljs-string">'Periodendauer'</span>, `${<span class="hljs-number">6</span>/speedmod}s`);
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setl</span><span class="hljs-params">()</span> </span>{
    l = gui.getValue(<span class="hljs-string">'l'</span>);
}
 
<span class="hljs-comment">/*
 *  Initialisierung
 */</span>
gui.setValue(<span class="hljs-string">'Geschwindigkeit'</span>, speedmod); <span class="hljs-comment">// Initialwert der Variable im Dropdown setzen</span>
 
<span class="hljs-comment">// Animation starten</span>
render();
 
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<p>Noch effizienter ist es allerdings auf die externen Callbackfunktionen wie <code>changeSpeed()</code> zu verzichten und den Callback direkt im gui Objekt anonym als <code>function(value) { }</code> bzw. als Arrowfunktion <code>(value)=&gt;{ }</code> zu deklarieren. Hier wird dann direkt der Wert des Elements übergeben und braucht nicht mehr mit <code>.getValue()</code> abgerufen werden.</p>
<p>Auf diese Art sieht der Quelltext des Beispiels folgendermaßen aus:</p>
<pre><code class="code-line language-HTML"><div><span class="hljs-meta">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">'utf-8'</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Kurbel<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
 
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"c"</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"300"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border-width:1px;border-style:solid"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://gitcdn.xyz/repo/goessner/g2/master/src/g2.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/quicksettings@latest/quicksettings.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
 
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">
 
<span class="hljs-keyword">const</span> cnv = document.getElementById(<span class="hljs-string">'c'</span>),
      ctx = cnv.getContext(<span class="hljs-string">'2d'</span>),
      pi = Math.PI;
 
 
 
let l = <span class="hljs-number">100</span>,  <span class="hljs-comment">// Laenge der Kurbel </span>
    phi = <span class="hljs-number">0</span>, <span class="hljs-comment">// Laufvariable</span>
    speedmod = <span class="hljs-number">1</span>,  <span class="hljs-comment">// Faktor der die Geschwindigkeit modifiziert</span>
 
    mec = {
        <span class="hljs-keyword">get</span> ephi() { <span class="hljs-keyword">return</span> {x:Math.cos(phi), y:Math.sin(phi)}; },
        <span class="hljs-keyword">get</span> A() { <span class="hljs-keyword">return</span> {x:l*mec.ephi.x, y:l*mec.ephi.y}; }
    },
 
    Kurbel = g2(),  <span class="hljs-comment">// definiert Kurbel als g2() Objekt</span>
 
    <span class="hljs-comment">// baut und initialisiert statische Umgebung</span>
    world = g2().clr().view({x:<span class="hljs-number">150</span>,y:<span class="hljs-number">150</span>,cartesian:<span class="hljs-literal">true</span>})
                .use({grp:Kurbel})
                .nodfix(),
 
    run = <span class="hljs-literal">true</span>  <span class="hljs-comment">// Boolean als Schalter um zu pruefen ob Animation laeuft</span>
 
    gui = QuickSettings.create(<span class="hljs-number">318</span>, <span class="hljs-number">8</span>, <span class="hljs-string">'Kurbel'</span>) <span class="hljs-comment">// Initiale Position vom body margin: 8px, canvas + border 300 + 2px</span>
             .addButton(<span class="hljs-string">'Start/Stop'</span>, () =&gt; { run = !run; })
             .addDropDown(<span class="hljs-string">'Geschwindigkeit'</span>, [<span class="hljs-number">0.5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>], (valueobject) =&gt; {
                speedmod = +valueobject.value;
                gui.setValue(<span class="hljs-string">'Periodendauer'</span>, `${<span class="hljs-number">6</span>/speedmod}s`); <span class="hljs-comment">// nicht this.setValue() verwenden, weil this hier das window-Objekt ist und nicht gui</span>
             })
             .addHTML(<span class="hljs-string">'Periodendauer'</span>, `${<span class="hljs-number">6</span>/speedmod}s`)
             .addBoolean(<span class="hljs-string">'Drehrichtung umkehren'</span>, <span class="hljs-literal">false</span>) <span class="hljs-comment">// kein Callback notwendig weil im Animationscallback (render() -&gt; positiom()) evaluiert</span>
             .addRange(<span class="hljs-string">'l'</span>, <span class="hljs-number">20</span>, <span class="hljs-number">150</span>, <span class="hljs-number">100</span>, <span class="hljs-number">1</span>, (value) =&gt; { l = value; })
    ;
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">position</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// baut dynamische Kurbel auf</span>
    Kurbel.del()
          .lin({x1:<span class="hljs-number">0</span>, y1:<span class="hljs-number">0</span>, x2:mec.A.x, y2:mec.A.y, lw:<span class="hljs-number">3</span>})
          .nod(mec.A);
 
    <span class="hljs-comment">// inkrementiert phi</span>
    <span class="hljs-keyword">if</span> (run) {
        <span class="hljs-keyword">if</span> (gui.getValue(<span class="hljs-string">'Drehrichtung umkehren'</span>)) {
            phi -= speedmod*pi/<span class="hljs-number">180</span>;
        } <span class="hljs-keyword">else</span> {
            phi += speedmod*pi/<span class="hljs-number">180</span>;
        }
    }
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">render</span><span class="hljs-params">()</span> </span>{
    position();  <span class="hljs-comment">// aktualisiere Position</span>
    world.exe(ctx);  <span class="hljs-comment">// rendert world in den Context</span>
    requestAnimationFrame(render);  <span class="hljs-comment">// asynchroner callback von render(), keine Rekursion!</span>
}
 
<span class="hljs-comment">/*
 *  Initialisierung
 */</span>
gui.setValue(<span class="hljs-string">'Geschwindigkeit'</span>, speedmod); <span class="hljs-comment">// Initialwert der Variable im Dropdown setzen</span>
 
<span class="hljs-comment">// Animation starten</span>
render();
 
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>

</article>
</main>
<script src="../js/g2.html.js"></script>
<script src="../js/mec2.html.js"></script>
</body>
</html>